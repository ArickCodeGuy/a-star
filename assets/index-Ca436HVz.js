(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const J={cells:[[0,1,0],[1,1,1],[0,1,0]]},V={cells:[[1,1,1],[1,1,1],[1,1,1]]},ee={cells:[[1,1,1],[1,0,1],[1,1,1]]},te={cells:[[1,1,1],[1,0,0],[1,0,0]]},re={cells:[[0,0,1],[0,1,1],[1,1,0]]},ne=[J,V,ee,te,re];function p([n,e]){return`${n},${e}`}function y(n){return n.split(",").map(Number)}function ie(n,e){if(!e.length)return{};const t=e[0].cells.length,r={},i=e.reduce((s,o,c)=>(s.set(c,o),s),new Map);for(const[s,o]of Object.entries(n)){const c=i.get(o);if(!c)throw new Error(`Chunk is not provided. id: ${o}`);const[a,l]=y(s);for(let h=0;h<t;h++)for(let f=0;f<t;f++){const d=c.cells[h][f];if(!d)continue;const u=p([a*t+f,l*t+h]);r[u]=d}}return r}function se(n){if(!n.length)throw new Error(`Array is empty: ${n}`);return Math.floor(Math.random()*n.length)}function b(n){if(!n.length)throw new Error(`Array is empty: ${n}`);const e=Math.floor(Math.random()*n.length);return n[e]}const H={LEFT:[1,0],RIGHT:[-1,0],DOWN:[0,1],UP:[0,-1]},oe=Object.values(H),ce=Object.keys(H),S={LEFT:[0,1],DOWN:[1,0],RIGHT:[0,1],UP:[1,0]},m=50,T="CHUNK_CELL";function Q([n,e],t){const r=t.length,i=t[0].length;return n<0||e<0||n>=i||e>=r}function ae(n,e){const t=n.length,[r,i]=S[e];let s=0,o=0;for(e==="LEFT"&&(o=t-1),e==="DOWN"&&(s=t-1);!Q([o,s],n);){if(n[s][o]!==0)return!0;o+=r,s+=i}return!1}function he([n,e],t,r){let i=n,s=e;switch(r){case"LEFT":i=0;break;case"RIGHT":i=t-1;break;case"DOWN":s=0;break;case"UP":s=t-1;break}return[i,s]}function N(n,e,t){if(!ae(n,t))return!1;const r=n.length,[i,s]=S[t];let o=0,c=0;for(t==="LEFT"&&(c=r-1),t==="DOWN"&&(o=r-1);!Q([c,o],n);){const[a,l]=he([c,o],r,t);if(n[o][c]&&e[l][a])return!0;o+=s,c+=i}return!1}function ue(n,e,t){return e.reduce((r,i,s)=>(N(e[n].cells,i.cells,t)&&r.push(s),r),[])}function le(n,e,t){const r=[],[i,s]=H[t];for(const[o,c]of Object.entries(n)){const[a,l]=y(o),h=a+i,f=l+s,d=p([h,f]);if(!n[d]){for(const u of e)if(N(e[c].cells,u.cells,t)){r.push(d);break}}}return r}function fe(n,e,t){let[r,i]=H[e];const[s,o]=y(n);return r=-r,i=-i,p([s+r,o+i])}function pe(n,e,t){const r={};let i=n+Math.floor(Math.random()*(e+1));r[p([0,0])]=se(t);for(let s=1;s<i;s++){const o=b(ce),c=le(r,t,o);if(!c.length){console.warn("No appendable chunks. Should fix probably",r,o),i=Math.min(1e4,i+1);continue}const a=b(c),l=fe(a,o),h=r[l],f=b(ue(h,t,o));r[a]=f}return r}function de(n,e,t){return ie(pe(n,e,t),t)}const ye=(n,e)=>()=>{n.fillStyle="black",n.fillRect(0,0,e.size[0],e.size[1])};function _e(n,e,t){n.fillStyle=e.color;const r=(e.x-t.translate[0])*t.zoom.current,i=(e.y-t.translate[1])*t.zoom.current;n.fillRect(r,i,e.width*t.zoom.current,e.height*t.zoom.current),e.text&&e.textColor&&t.zoom.current<1.5&&t.zoom.current>.8&&(n.font="10px Arial",n.fillStyle=e.textColor,n.fillText(e.text,r+3,i+10))}const me=(n,e)=>{const t=ye(n,e);return()=>{t();for(const r of e.objects)switch(r.type){case"rect":_e(n,r,e);break}}};function q(n,e){return[e.translate[0]+n[0]/e.zoom.current,e.translate[1]+n[1]/e.zoom.current]}function we(n,e){return[n[0]-e.size[0]/2/e.zoom.current,n[1]-e.size[1]/2/e.zoom.current]}const xe=(n,e)=>{let t=0,r=0,i=0,s=0;function o(u){const _=(u.clientX-t)/e.zoom.current,x=(u.clientY-r)/e.zoom.current;e.translate=[i-_,s-x]}function c(u){t=u.clientX,r=u.clientY,[i,s]=e.translate,document.addEventListener("mousemove",o),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",o)},{once:!0})}function a(u){var _;(_=e.onClick)==null||_.call(e,u,e)}function l(u){u.preventDefault(),f(-Math.sign(u.deltaY))}function h(u){u.key!=="="&&u.key!=="-"||(u.preventDefault(),f(u.key==="="?1:-1))}function f(u){const _=(e.zoom.max-e.zoom.min)/100,x=q(e.size.map(G=>G/2),e),j=Math.min(e.zoom.max,Math.max(e.zoom.min,e.zoom.current+_*u));e.zoom.current=j,e.translate=we(x,e)}n.addEventListener("mousedown",c),n.addEventListener("dblclick",a),n.addEventListener("wheel",l),document.addEventListener("keydown",h);function d(){n.removeEventListener("mousedown",c),n.removeEventListener("dblclick",a),n.removeEventListener("wheel",l),document.addEventListener("keydown",h)}return d},R=800,k=500,Ee={translate:[-R/2,-k/2],size:[R,k],zoom:{min:.1,max:10,current:1},renderDistance:3,objects:[]},Me=(n,e={})=>{const t={...Ee,...e},r=document.createElement("canvas"),i=r.getContext("2d"),s=me(i,t);r.width=t.size[0],r.height=t.size[1];const o=xe(r,t);return setInterval(()=>{s()},1e3/60),n.appendChild(r),{canvas:r,options:t,removeEventListeners:o}};var U={},w={},P={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 *
 * @class
 */let ze=class M{constructor(e,t,r){if(typeof e!="function")throw new Error("Heap constructor expects a compare function");this._compare=e,this._nodes=Array.isArray(t)?t:[],this._leaf=r||null}toArray(){return Array.from(this._nodes)}_hasLeftChild(e){return e*2+1<this.size()}_hasRightChild(e){return e*2+2<this.size()}_compareAt(e,t){return this._compare(this._nodes[e],this._nodes[t])}_swap(e,t){const r=this._nodes[e];this._nodes[e]=this._nodes[t],this._nodes[t]=r}_shouldSwap(e,t){return e<0||e>=this.size()||t<0||t>=this.size()?!1:this._compareAt(e,t)>0}_compareChildrenOf(e){if(!this._hasLeftChild(e)&&!this._hasRightChild(e))return-1;const t=e*2+1,r=e*2+2;return this._hasLeftChild(e)?this._hasRightChild(e)&&this._compareAt(t,r)>0?r:t:r}_compareChildrenBefore(e,t,r){return this._compareAt(r,t)<=0&&r<e?r:t}_heapifyUp(e){let t=e,r=Math.floor((t-1)/2);for(;this._shouldSwap(r,t);)this._swap(r,t),t=r,r=Math.floor((t-1)/2)}_heapifyDown(e){let t=e,r=this._compareChildrenOf(t);for(;this._shouldSwap(t,r);)this._swap(t,r),t=r,r=this._compareChildrenOf(t)}_heapifyDownUntil(e){let t=0,r=1,i=2,s;for(;r<e;)s=this._compareChildrenBefore(e,r,i),this._shouldSwap(t,s)&&this._swap(t,s),t=s,r=t*2+1,i=t*2+2}insert(e){return this._nodes.push(e),this._heapifyUp(this.size()-1),(this._leaf===null||this._compare(e,this._leaf)>0)&&(this._leaf=e),this}push(e){return this.insert(e)}extractRoot(){if(this.isEmpty())return null;const e=this.root();return this._nodes[0]=this._nodes[this.size()-1],this._nodes.pop(),this._heapifyDown(0),e===this._leaf&&(this._leaf=this.root()),e}pop(){return this.extractRoot()}sort(){for(let e=this.size()-1;e>0;e-=1)this._swap(0,e),this._heapifyDownUntil(e);return this._nodes}fix(){for(let e=Math.floor(this.size()/2)-1;e>=0;e-=1)this._heapifyDown(e);for(let e=Math.floor(this.size()/2);e<this.size();e+=1){const t=this._nodes[e];(this._leaf===null||this._compare(t,this._leaf)>0)&&(this._leaf=t)}return this}isValid(){const e=t=>{let r=!0,i=!0;if(this._hasLeftChild(t)){const s=t*2+1;if(this._compareAt(t,s)>0)return!1;r=e(s)}if(this._hasRightChild(t)){const s=t*2+2;if(this._compareAt(t,s)>0)return!1;i=e(s)}return r&&i};return e(0)}clone(){return new M(this._compare,this._nodes.slice(),this._leaf)}root(){return this.isEmpty()?null:this._nodes[0]}top(){return this.root()}leaf(){return this._leaf}size(){return this._nodes.length}isEmpty(){return this.size()===0}clear(){this._nodes=[],this._leaf=null}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("Heap.heapify expects an array of values");if(typeof t!="function")throw new Error("Heap.heapify expects a compare function");return new M(t,e).fix()}static isHeapified(e,t){return new M(t,e).isValid()}};P.Heap=ze;var $={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 */const{Heap:A}=P,g=n=>(e,t)=>{const r=typeof n=="function"?n(e):e,i=typeof n=="function"?n(t):t;return r<=i?-1:1};let ve=class z{constructor(e,t){this._getCompareValue=e,this._heap=t||new A(g(e))}toArray(){return Array.from(this._heap._nodes)}insert(e){return this._heap.insert(e)}push(e){return this.insert(e)}extractRoot(){return this._heap.extractRoot()}pop(){return this.extractRoot()}sort(){return this._heap.sort()}fix(){return this._heap.fix()}isValid(){return this._heap.isValid()}root(){return this._heap.root()}top(){return this.root()}leaf(){return this._heap.leaf()}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}clone(){return new z(this._getCompareValue,this._heap.clone())}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("MinHeap.heapify expects an array");const r=new A(g(t),e);return new z(t,r).fix()}static isHeapified(e,t){const r=new A(g(t),e);return new z(t,r).isValid()}};$.MinHeap=ve;var I={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 */const{Heap:L}=P,C=n=>(e,t)=>{const r=typeof n=="function"?n(e):e,i=typeof n=="function"?n(t):t;return r<i?1:-1};let He=class v{constructor(e,t){this._getCompareValue=e,this._heap=t||new L(C(e))}insert(e){return this._heap.insert(e)}push(e){return this.insert(e)}extractRoot(){return this._heap.extractRoot()}pop(){return this.extractRoot()}sort(){return this._heap.sort()}toArray(){return Array.from(this._heap._nodes)}fix(){return this._heap.fix()}isValid(){return this._heap.isValid()}root(){return this._heap.root()}top(){return this.root()}leaf(){return this._heap.leaf()}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}clone(){return new v(this._getCompareValue,this._heap.clone())}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static heapify(e,t){if(!Array.isArray(e))throw new Error("MaxHeap.heapify expects an array");const r=new L(C(t),e);return new v(t,r).fix()}static isHeapified(e,t){const r=new L(C(t),e);return new v(t,r).isValid()}};I.MaxHeap=He;const{Heap:Pe}=P,{MinHeap:be}=$,{MaxHeap:Ae}=I;w.Heap=Pe;w.MinHeap=be;w.MaxHeap=Ae;/**
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 * @license MIT
 */const{Heap:ge,MinHeap:D}=w,Le=n=>(e,t)=>{const r=typeof n=="function"?n(e):e,i=typeof n=="function"?n(t):t;return r<=i?-1:1};let Ce=class F{constructor(e,t){if(e&&typeof e!="function")throw new Error("MinPriorityQueue constructor requires a callback for object values");this._heap=t||new D(e)}front(){return this._heap.root()}back(){return this._heap.leaf()}enqueue(e){return this._heap.insert(e)}push(e){return this.enqueue(e)}dequeue(){return this._heap.extractRoot()}pop(){return this.dequeue()}remove(e){if(typeof e!="function")throw new Error("MinPriorityQueue remove expects a callback");const t=[],r=[];for(;!this.isEmpty();){const i=this.pop();e(i)?t.push(i):r.push(i)}return r.forEach(i=>this.push(i)),t}contains(e){if(typeof e!="function")throw new Error("MinPriorityQueue contains expects a callback");let t=!1;const r=[];for(;!this.isEmpty();){const i=this.pop();if(r.push(i),e(i)){t=!0;break}}return r.forEach(i=>this.push(i)),t}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}toArray(){return this._heap.clone().sort().reverse()}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static fromArray(e,t){const r=new ge(Le(t),e);return new F(t,new D(t,r).fix())}};U.MinPriorityQueue=Ce;var K={};/**
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 * @license MIT
 */const{Heap:Re,MaxHeap:O}=w,ke=n=>(e,t)=>{const r=typeof n=="function"?n(e):e,i=typeof n=="function"?n(t):t;return r<i?1:-1};let De=class W{constructor(e,t){if(e&&typeof e!="function")throw new Error("MaxPriorityQueue constructor requires a callback for object values");this._heap=t||new O(e)}front(){return this._heap.root()}back(){return this._heap.leaf()}enqueue(e){return this._heap.insert(e)}push(e){return this.enqueue(e)}dequeue(){return this._heap.extractRoot()}pop(){return this.dequeue()}remove(e){if(typeof e!="function")throw new Error("MaxPriorityQueue remove expects a callback");const t=[],r=[];for(;!this.isEmpty();){const i=this.pop();e(i)?t.push(i):r.push(i)}return r.forEach(i=>this.push(i)),t}contains(e){if(typeof e!="function")throw new Error("MaxPriorityQueue contains expects a callback");let t=!1;const r=[];for(;!this.isEmpty();){const i=this.pop();if(r.push(i),e(i)){t=!0;break}}return r.forEach(i=>this.push(i)),t}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}toArray(){return this._heap.clone().sort().reverse()}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static fromArray(e,t){const r=new Re(ke(t),e);return new W(t,new O(t,r).fix())}};K.MaxPriorityQueue=De;var Y={};/**
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 * @license MIT
 */const{Heap:Oe}=w;let Se=class B{constructor(e,t){if(typeof e!="function")throw new Error("PriorityQueue constructor expects a compare function");this._heap=new Oe(e,t),t&&this._heap.fix()}front(){return this._heap.root()}back(){return this._heap.leaf()}enqueue(e){return this._heap.insert(e)}push(e){return this.enqueue(e)}dequeue(){return this._heap.extractRoot()}pop(){return this.dequeue()}remove(e){if(typeof e!="function")throw new Error("PriorityQueue remove expects a callback");const t=[],r=[];for(;!this.isEmpty();){const i=this.pop();e(i)?t.push(i):r.push(i)}return r.forEach(i=>this.push(i)),t}contains(e){if(typeof e!="function")throw new Error("PriorityQueue contains expects a callback");let t=!1;const r=[];for(;!this.isEmpty();){const i=this.pop();if(r.push(i),e(i)){t=!0;break}}return r.forEach(i=>this.push(i)),t}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}toArray(){return this._heap.clone().sort().reverse()}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static fromArray(e,t){return new B(t,e)}};Y.PriorityQueue=Se;const{MinPriorityQueue:Te}=U,{MaxPriorityQueue:Qe}=K,{PriorityQueue:Ne}=Y;var qe={MinPriorityQueue:Te,MaxPriorityQueue:Qe,PriorityQueue:Ne};function Ue([n,e]){const t=Math.abs(e[0]-n[0]),r=Math.abs(e[1]-n[1]);return t+r}function $e(n,e){if(!e[n])return[];const[t,r]=y(n);let i=[];for(const[s,o]of oe)i.push(p([t+s,r+o]));return i}function E([n,e,t],r,i){const s=Ue([[n,e],i]);return[t+s,t,s]}function Ie(n,e,t){if(!n||!e)return[];if(n[0]===e[0]&&n[1]===e[1])return console.warn("Start position is end position"),[];if(!t[p(n)])return console.warn("Start position is invalid"),[];if(!t[p(e)])return console.warn("End position is invalid"),[];if(p(n)===p(e))return console.warn("Start position === End position"),[n];const r=new qe.PriorityQueue((a,l)=>{const h=E(a,n,e),f=E(l,n,e);return h[0]===f[0]?h[2]-f[2]:h[0]-f[0]});r.push([...n,0]);const i=new Set,s=new Map;for(;r.size();){const[a,l,h]=r.pop();if(a===e[0]&&l===e[1])break;const f=p([a,l]);if(!i.has(f)){i.add(f);for(const d of $e(f,t)){if(i.has(d))continue;const u=y(d);if(r.push([...u,h+1]),!s.has(d)){s.set(d,[a,l,h+1]);continue}const _=E(s.get(d),n,e),x=E([a,l,h+1],n,e);_[0]<=x[0]||s.set(d,[a,l,h+1])}}}if(!s.has(p(e)))return[];const o=[];let c=e;for(;c[0]!==n[0]||c[1]!==n[1];){o.push(c);const[a,l]=s.get(p(c));c=[a,l]}return o.push(n),o.reverse(),o}function Fe(n,e){const t=[];let r=[];function i(){for(const c of r)n.get(p(c)).color="white"}function s(){for(const c of r)n.get(p(c)).color="yellow";n.get(p(r[r.length-1])).color="red",n.get(p(r[0])).color="green"}return{select:c=>{if(i(),t[0]&&!t[1]?t.push(c):(t.pop(),t[0]=c),t[1]){const[a,l]=t.map(y),h=Ie(a,l,e);h.length?r=h:r=t.map(y)}else r=t.map(y);s()}}}function Ke([n,e],t){switch(t.type){case"rect":return n>=t.x&&e>=t.y&&n<=t.x+t.width&&e<=t.y+t.height}}const We=n=>(e,t)=>{const r=q([e.offsetX,e.offsetY],t);for(const i of t.objects)!Ke(r,i)||i.name!==T||n.select(p([Math.floor(r[0]/m),Math.floor(r[1]/m)]))};function Ye(n){const e=new Map;for(const[t,r]of Object.entries(n)){const[i,s]=y(t);e.set(t,{type:"rect",name:T,x:m*i,y:m*s,width:m-1,height:m-1,color:"white",text:String(r),textColor:"black"})}return e}const Be=document.querySelector("#app"),X=de(15,5,ne),Z=Ye(X),Xe=Fe(Z,X);Me(Be,{objects:[...Z.values()],onClick:We(Xe)});
